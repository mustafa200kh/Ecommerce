import{r as d,j as e,b as w,a as j,q as N,t as y,v as C,w as k,x as D,y as A,z as M,m as v}from"./index-kuPgm23o.js";import{L as I}from"./Loading-Dvm_kJQt.js";import{P}from"./PageHeader-DojtT84v.js";import{S as F}from"./LoginRequiredMessage-ChcW2L1u.js";const L=({img:s,id:l,max:t,quantity:r,price:n,title:o,changeCartQuantity:m,DeleteItem:h})=>{let[u,x]=d.useState(!1);const i=Array(t).fill(0).map((c,b)=>++b).map(c=>e.jsx("option",{value:c,children:c},c)),a=c=>{const b=+c.target.value;m(l,b)},g=u?"scale-1":"scale-0";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed top-0 left-0 w-full h-[100vh] bg-black bg-opacity-40 z-30 transition-all duration-300 ${g}`,children:e.jsx(H,{id:l,title:o,settingDeleteMessage:x,DeleteItem:h})}),e.jsxs("div",{className:"p-3 flex flex-col md:flex-row gap-2 border-b-[1px] border-[#ddd] border-solid",children:[e.jsx("div",{className:"md:basis-1/5",children:e.jsx("img",{className:"md:h-52",src:s,alt:o})}),e.jsxs("div",{className:"flex-1 flex md:flex-col justify-between items-center md:items-start dark:text-white",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-xl",children:o}),e.jsxs("span",{className:"block",children:[" ",n.toFixed(2),"$"]})]}),e.jsx("div",{className:"p-3",children:e.jsxs("button",{className:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md",onClick:()=>x(c=>!c),children:[e.jsx("svg",{stroke:"currentColor",viewBox:"0 0 24 24",fill:"none",className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"})}),"Delete"]})})]}),e.jsxs("div",{className:"md:basis-1/5 self-center dark:text-white",children:[e.jsx("h2",{className:"mb-2 text-lg",children:" Quantity"}),e.jsx("select",{className:"p-1 w-full md:w-14 border-solid border-2 dark:bg-darktext dark:border-white dark:outline-none border-black focus:border-mainColor rounded-md",value:r,onChange:c=>a(c),children:i})]})]})]})},O=({products:s})=>{const l=w(),[t,r]=d.useState(!1),[n,o]=d.useState(!1),[m,h]=d.useState(null),{accessToken:u}=j(i=>i.auth);let x=s.reduce((i,a)=>{let g=a.quantity,c=a.price;return g&&typeof g=="number"?i+c*g:i},0);const p=()=>{r(!t)},f=()=>{o(!0),l(N(x)).unwrap().then(()=>{r(!1),l(y())}).catch(i=>{h(i)}).finally(()=>o(!1))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed z-50 top-0 left-0 w-full h-screen bg-black bg-opacity-15 transition-all duration-200 ${!t&&"-translate-y-full"}`,children:e.jsx(B,{loading:n,error:m,modalHandler:p,placingOrderHandler:f,totalPrice:x})}),e.jsxs("div",{className:"flex justify-between items-center p-3",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-white",children:"SubTotal Price:"}),e.jsxs("p",{className:"text-lg font-semibold dark:text-white",children:[" ",x.toFixed(2),"$"]})]}),u&&e.jsx("div",{className:"w-full p-3",children:e.jsx("button",{className:"btn-primary text-white bg-mainColor hover:bg-hoverColor border-mainColor hover:border-hoverColor hover:scale-105 block ml-auto",onClick:()=>{p()},children:"PlaceOrder"})})]})},S=({products:s,changeCartQuantity:l,DeleteItem:t})=>{let r=s.map(n=>e.jsx(L,{...n,changeCartQuantity:l,DeleteItem:t},n.id));return e.jsx(e.Fragment,{children:r})},H=({id:s,title:l,settingDeleteMessage:t,DeleteItem:r})=>{const n=()=>{r(s)};return e.jsxs("div",{className:"w-[80vw] md:w-[50vw] lg:w-[25vw] fixed top-1/2 left-1/2 translate-x-[-50%] translate-y-[-50%] z-40 p-7 bg-white text-center rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl mb-5",children:" Delete Item ?"}),e.jsxs("p",{className:" mb-5",children:["Are you sure you want to delete (",l,") From Your cart?"]}),e.jsxs("div",{className:"flex items-center justify-center gap-8 text-lg",children:[e.jsx("button",{className:"btn-message bg-[#ddd] hover:bg-[#c5c5c5]",onClick:()=>{t(!1)},children:"Cancel"}),e.jsx("button",{className:"btn-message text-white bg-[#ff726d] hover:bg-red-600",onClick:()=>{t(!1),n()},children:"Delete"})]})]})},z=({setDeleteAllMsg:s,ActivateDeleteAllAction:l})=>e.jsx("div",{className:"fixed select-none w-[80vw] md:w-[50vw] lg:w-[25vw] flex flex-col p-4 items-center justify-center bg-white shadow-lg rounded-2xl top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"text-center p-3 flex-auto justify-center",children:[e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"animate-bounce w-12 h-12 flex items-center text-gray-600 fill-red-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{clipRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",fillRule:"evenodd"})}),e.jsx("h2",{className:"text-xl font-bold py-4",children:"Delete All?"}),e.jsx("p",{className:"font-bold text-gray-500 px-2",children:"Do you really want to continue deleting all items from cart, This process cannot be undone"})]}),e.jsxs("div",{className:"p-2 mt-2 text-center space-x-8 md:block",children:[e.jsx("button",{className:"btn-message bg-[#ddd] hover:bg-[#c5c5c5]",onClick:()=>{s(!1)},children:"Cancel"}),e.jsx("button",{className:"btn-message text-white bg-[#ff726d] hover:bg-red-600",onClick:()=>{l(),s(!1)},children:"Confirm"})]})]})}),B=({error:s,loading:l,modalHandler:t,placingOrderHandler:r,totalPrice:n})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fixed shadow-md w-[300px] md:w-[500px] top-1/4 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white p-5 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between pb-5",children:[e.jsx("h2",{className:"text-2xl",children:" Placing Order Confirmation "}),e.jsx("div",{className:"cursor-pointer",onClick:()=>{t()},children:e.jsx(F,{})})]}),e.jsx("hr",{className:"mb-5"}),e.jsxs("p",{className:"mb-5",children:["Are you sure you want to place the order with subTotal:",n.toFixed(2),"$"]}),!l&&s&&e.jsx("p",{className:"mb-5 text-red-600",children:s}),e.jsx("hr",{className:"mb-2"}),e.jsxs("div",{className:"flex items-center justify-end gap-5",children:[e.jsx("button",{className:"block p-2 rounded-md bg-[#ddd] hover:bg-[#c5c5c5]",onClick:()=>{t()},children:"Close"}),e.jsx("button",{className:"bg-mainColor hover:bg-hoverColor text-white block p-2 rounded-md",onClick:()=>{r()},children:l?"loading...":"Place Order"})]})]})}),Q=()=>{let[s,l]=d.useState(!1);const t=w(),{items:r,loading:n,error:o,productFullInfo:m}=j(a=>a.cart),h=j(a=>a.order.loading);let u=m.map(a=>({...a,quantity:r[a.id]}));const x=d.useCallback((a,g)=>{t(C({id:a,quantity:g}))},[t]),p=d.useCallback(a=>{t(k(a))},[t]),f=d.useCallback(()=>{t(y())},[]);let i=s?"":"translate-x-full";return d.useEffect(()=>{const a=t(D());return()=>{a.abort(),t(A()),t(M())}},[]),{loading:n,error:o,cartProducts:u,changeCartQuantity:x,DeleteItem:p,DeleteAllItemsFromCart:f,setDeleteAllConfimMsg:l,MessageDisplay:i,PlacingOrderLoading:h}},R=()=>{const{loading:s,error:l,cartProducts:t,changeCartQuantity:r,DeleteItem:n,DeleteAllItemsFromCart:o,setDeleteAllConfimMsg:m,MessageDisplay:h,PlacingOrderLoading:u}=Q();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed top-0 left-0 w-full h-[100vh] bg-black bg-opacity-20 z-30 transition-all delay-200 ${h}`,children:e.jsx(z,{setDeleteAllMsg:m,ActivateDeleteAllAction:o})}),e.jsxs("div",{className:"flex items-center justify-between ",children:[e.jsx(P,{title:"My Cart"}),t.length>0&&e.jsx("div",{className:"pr-3 md:pr-0",children:e.jsxs("button",{className:"inline-flex items-center px-4 py-2 bg-red-600 transition ease-in-out delay-75 hover:bg-red-700 text-white text-sm font-medium rounded-md hover:-translate-y-1 hover:scale-105",onClick:()=>{m(!0)},children:[e.jsx("svg",{stroke:"currentColor",viewBox:"0 0 24 24",fill:"none",className:"h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"})}),"Delete All"]})})]}),e.jsx(I,{loading:s,error:l,type:"cart",children:t.length==0?u==="succeded"?s!=="idle"&&e.jsx(v,{message:"Your order has been placed successfuly",type:"success"}):e.jsx(v,{message:"Your cart is empty",type:"empty"}):e.jsxs(e.Fragment,{children:[e.jsx(S,{products:t,changeCartQuantity:r,DeleteItem:n}),e.jsx(O,{products:t})]})})]})};export{R as default};
