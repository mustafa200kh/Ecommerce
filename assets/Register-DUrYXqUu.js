import{r as j,n as A,b as N,a as k,u as I,k as D,o as F,j as e,p as R}from"./index-kuPgm23o.js";import"./LoginRequiredMessage-ChcW2L1u.js";import{P as O}from"./PageHeader-DojtT84v.js";import{z as l,u as P,t as q,I as c}from"./zod-D6sUtNLf.js";const B=l.object({firstname:l.string().min(1,{message:"First name is required"}),lastname:l.string().min(1,{message:"First name is required"}),email:l.string().min(1,{message:"Email is required"}).email(),password:l.string().min(8,{message:"password should be at least 8 characters"}).regex(/[*@!#%&()^~{}]+/,{message:"you password should contains at least 1 special character"}),confirmpassword:l.string().min(1,{message:"confirm password is required"})}).refine(s=>s.password===s.confirmpassword,{message:"password is not matched",path:["confirmpassword"]}),C=()=>{const[s,t]=j.useState("idle"),[n,i]=j.useState(null);return{checkEmailAvalibility:async a=>{t("checking"),i(a);try{(await A.get(`/users?email=${a}`)).data.length?t("notAvaliable"):t("avaliable")}catch{t("failed")}},emailAvalibilityStatus:s,enteredEmail:n,resetDataOnInvalidInput:()=>{t("idle"),i(null)}}},H=()=>{const s=N(),{loading:t,error:n,accessToken:i}=k(m=>m.auth),r=I(),{checkEmailAvalibility:d,emailAvalibilityStatus:a,resetDataOnInvalidInput:o,enteredEmail:u}=C(),{register:g,handleSubmit:p,trigger:h,getFieldState:b,formState:{errors:f}}=P({mode:"onBlur",resolver:q(B)}),x=async m=>{const{firstname:v,lastname:w,email:y,password:E}=m;s(F({firstname:v,lastname:w,email:y,password:E})).unwrap().then(()=>{r("/login?message=account_created")})},S=async m=>{await h("email");const v=m.target.value,{isDirty:w,invalid:y}=b("email");w&&!y&&u!==v&&d(v),w&&y&&u&&o()};return j.useEffect(()=>{s(D())},[s]),{loading:t,error:n,accessToken:i,emailAvalibilityStatus:a,register:g,handleSubmit:p,formState:{errors:f},onSubmit:x,emailOnBlurHandling:S}},M=()=>{var g,p,h,b,f,x;const{loading:s,error:t,accessToken:n,emailAvalibilityStatus:i,register:r,handleSubmit:d,formState:{errors:a},onSubmit:o,emailOnBlurHandling:u}=H();return n?e.jsx(R,{to:"/"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-5 text-center text-mainColor md:font-semibold ",children:e.jsx(O,{title:"Registeration"})}),e.jsx("div",{className:"px-3 md:w-3/4 mx-auto",children:e.jsxs("form",{onSubmit:d(o),children:[e.jsxs("div",{className:"flex items-start gap-5",children:[e.jsx("div",{className:"basis-1/2",children:e.jsx(c,{error:(g=a.firstname)==null?void 0:g.message,name:"firstname",register:r,label:"First Name",placeholder:"Jhon"})}),e.jsx("div",{className:"basis-1/2",children:e.jsx(c,{error:(p=a.lastname)==null?void 0:p.message,name:"lastname",register:r,label:"Last Name",placeholder:"Doe"})})]}),e.jsx(c,{error:(h=a.email)!=null&&h.message?(b=a.email)==null?void 0:b.message:i==="notAvaliable"?"this email is already in use":"",name:"email",register:r,label:"Email",onBlur:u,placeholder:"jhondoe@mail.com",formText:i==="checking"?"we're chcecking if the email availbilty. Please wait a moment":"",success:i==="avaliable"?"this email avaliable for use":""}),e.jsx(c,{error:(f=a.password)==null?void 0:f.message,name:"password",register:r,label:"Password",placeholder:"Choose 8 character or more for strong password",type:"password"}),e.jsx(c,{error:(x=a.confirmpassword)==null?void 0:x.message,name:"confirmpassword",register:r,label:"Confirm Password",placeholder:"Re-write your choosen password here",type:"password"}),e.jsx("div",{className:"w-full flex justify-center items-center my-5",children:e.jsx("button",{type:"submit",className:"w-fit px-4 py-3 text-white rounded-md bg-blue-500 hover:bg-blue-700 focus:ring-4",disabled:i==="checking"?!0:s==="pending",children:s==="pending"?"loading...":"submit"})}),t&&e.jsxs("p",{className:"text-red-600 text-sm",children:[" ",t," "]})]})})]})};export{M as default};
